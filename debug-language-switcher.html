<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒæ¨¡å¼è¯­è¨€é€‰æ‹©å™¨è°ƒè¯•é¡µé¢</title>
    
    <!-- åŒæ¨¡å¼è¯­è¨€é€‰æ‹©å™¨æ ·å¼ -->
    <link rel="stylesheet" href="i18n/components/dual-mode-language-switcher.css">
    
    <!-- å¤‡ç”¨CSSæ£€æŸ¥ -->
    <script>
    // CSSæ–‡ä»¶åŠ è½½æ£€æŸ¥
    function checkCSSLoaded() {
        const link = document.querySelector('link[href*="dual-mode-language-switcher.css"]');
        if (link) {
            link.addEventListener('load', () => {
                console.log('âœ… CSSæ–‡ä»¶åŠ è½½å®Œæˆ');
            });
            link.addEventListener('error', () => {
                console.error('âŒ CSSæ–‡ä»¶åŠ è½½å¤±è´¥');
                // å°è¯•ä½¿ç”¨fallback CSS
                loadFallbackCSS();
            });
        }
    }
    
    function loadFallbackCSS() {
        console.log('ğŸ”„ åŠ è½½å¤‡ç”¨CSSæ ·å¼...');
        const style = document.createElement('style');
        style.textContent = `
        .dual-mode-language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .lang-dropdown-btn {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .lang-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            min-width: 200px;
            z-index: 10001;
        }
        .lang-dropdown.active .lang-dropdown-menu {
            display: block;
        }
        .lang-option {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .lang-option:hover {
            background: #f5f5f5;
        }
        .lang-option.active {
            background: #e3f2fd;
        }
        .mode-btn {
            background: #f5f5f5;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px;
        }
        .mode-btn.active {
            background: #2196f3;
            color: white;
        }
        `;
        document.head.appendChild(style);
        console.log('âœ… å¤‡ç”¨CSSå·²åŠ è½½');
    }
    
    checkCSSLoaded();
    </script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: #f5f7fa;
            margin: 0;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .debug-section {
            margin: 20px 0;
            padding: 20px;
            border-left: 4px solid #4f46e5;
            background: #f8f9ff;
            border-radius: 5px;
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
        .status-success { border-left: 4px solid #10b981; }
        .status-error { border-left: 4px solid #ef4444; }
        .status-warning { border-left: 4px solid #f59e0b; }
        
        .debug-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: 500;
        }
        .debug-btn:hover {
            background: #3730a3;
        }
        .debug-btn.success {
            background: #10b981;
        }
        .debug-btn.warning {
            background: #f59e0b;
        }
        .debug-btn.error {
            background: #ef4444;
        }
        
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .console-log {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1 data-i18n="debug_page_title">ğŸ”§ åŒæ¨¡å¼è¯­è¨€é€‰æ‹©å™¨è°ƒè¯•é¡µé¢</h1>
        <p data-i18n="debug_page_desc">è¿™ä¸ªé¡µé¢ç”¨äºè¯Šæ–­åŒæ¨¡å¼è¯­è¨€é€‰æ‹©å™¨çš„é—®é¢˜ã€‚è¯·æŒ‰é¡ºåºæ£€æŸ¥ä»¥ä¸‹é¡¹ç›®ï¼š</p>
        
        <!-- æµ‹è¯•ç¿»è¯‘åŒºåŸŸ -->
        <div class="debug-section">
            <h2>ğŸŒ ç¿»è¯‘æµ‹è¯•åŒºåŸŸ</h2>
            <div style="background: #fff3cd; padding: 15px; border-radius: 5px; margin: 10px 0;">
                <h3 data-i18n="test_title">æµ‹è¯•æ ‡é¢˜</h3>
                <p data-i18n="test_content">è¿™æ˜¯ä¸€æ®µæµ‹è¯•å†…å®¹ï¼Œç”¨äºéªŒè¯è¯­è¨€åˆ‡æ¢æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
                <button data-i18n="test_button">æµ‹è¯•æŒ‰é’®</button>
                <input type="text" data-i18n-placeholder="test_placeholder" placeholder="è¯·è¾“å…¥æµ‹è¯•å†…å®¹">
            </div>
            <div style="font-size: 12px; color: #666; margin-top: 10px;">
                <strong>è¯´æ˜ï¼š</strong>å¦‚æœè¯­è¨€åˆ‡æ¢æ­£å¸¸ï¼Œä¸Šæ–¹çš„æ–‡æœ¬åº”è¯¥ä¼šæ ¹æ®é€‰æ‹©çš„è¯­è¨€æ”¹å˜å†…å®¹ã€‚
            </div>
        </div>
        
        <!-- æ–‡ä»¶åŠ è½½æ£€æŸ¥ -->
        <div class="debug-section">
            <h2>ğŸ“‚ æ–‡ä»¶åŠ è½½æ£€æŸ¥</h2>
            <div id="fileChecks">
                <div class="status-item" id="cssCheck">
                    <span>CSSæ–‡ä»¶åŠ è½½</span>
                    <span id="cssStatus">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="jsCheck">
                    <span>JavaScriptæ–‡ä»¶åŠ è½½</span>
                    <span id="jsStatus">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="classCheck">
                    <span>DualModeLanguageSwitcherç±»</span>
                    <span id="classStatus">æ£€æŸ¥ä¸­...</span>
                </div>
            </div>
        </div>
        
        <!-- å®ä¾‹åŒ–æ£€æŸ¥ -->
        <div class="debug-section">
            <h2>ğŸ¯ å®ä¾‹åŒ–æ£€æŸ¥</h2>
            <div id="instanceChecks">
                <div class="status-item" id="instanceCheck">
                    <span>è¯­è¨€é€‰æ‹©å™¨å®ä¾‹</span>
                    <span id="instanceStatus">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="domCheck">
                    <span>DOMå…ƒç´ æŒ‚è½½</span>
                    <span id="domStatus">æ£€æŸ¥ä¸­...</span>
                </div>
            </div>
        </div>
        
        <!-- è¯­è¨€æ–‡ä»¶æ£€æŸ¥ -->
        <div class="debug-section">
            <h2>ğŸŒ è¯­è¨€æ–‡ä»¶æ£€æŸ¥</h2>
            <div id="languageChecks">
                <div class="status-item" id="zhCheck">
                    <span>ä¸­æ–‡è¯­è¨€æ–‡ä»¶ (zh.js)</span>
                    <span id="zhStatus">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="enCheck">
                    <span>è‹±æ–‡è¯­è¨€æ–‡ä»¶ (en.js)</span>
                    <span id="enStatus">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="jaCheck">
                    <span>æ—¥æ–‡è¯­è¨€æ–‡ä»¶ (ja.js)</span>
                    <span id="jaStatus">æ£€æŸ¥ä¸­...</span>
                </div>
            </div>
        </div>
        
        <!-- åŠŸèƒ½æµ‹è¯• -->
        <div class="debug-section">
            <h2>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h2>
            <div style="margin: 15px 0;">
                <button class="debug-btn" onclick="testLanguageSwitch('zh')">æµ‹è¯•ä¸­æ–‡åˆ‡æ¢</button>
                <button class="debug-btn" onclick="testLanguageSwitch('en')">æµ‹è¯•è‹±æ–‡åˆ‡æ¢</button>
                <button class="debug-btn" onclick="testLanguageSwitch('ja')">æµ‹è¯•æ—¥æ–‡åˆ‡æ¢</button>
                <button class="debug-btn warning" onclick="testModeSwitch('auto')">æµ‹è¯•è‡ªåŠ¨æ¨¡å¼</button>
                <button class="debug-btn warning" onclick="testModeSwitch('manual')">æµ‹è¯•æ‰‹åŠ¨æ¨¡å¼</button>
            </div>
            <div class="status-item" id="functionTest">
                <span>åŠŸèƒ½æµ‹è¯•ç»“æœ</span>
                <span id="functionStatus">ç­‰å¾…æµ‹è¯•...</span>
            </div>
        </div>
        
        <!-- æ§åˆ¶å°è¾“å‡º -->
        <div class="debug-section">
            <h2>ğŸ“ æ§åˆ¶å°è¾“å‡º</h2>
            <div class="console-log" id="consoleOutput">
                ç­‰å¾…è¾“å‡º...
            </div>
            <button class="debug-btn" onclick="clearConsole()">æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <!-- è§£å†³æ–¹æ¡ˆ -->
        <div class="debug-section">
            <h2>ğŸ’¡ å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>
            <div>
                <h3>å¦‚æœè¯­è¨€åˆ‡æ¢ä¸å·¥ä½œï¼š</h3>
                <div class="code-block">
1. ç¡®ä¿é€šè¿‡HTTPæœåŠ¡å™¨è®¿é—®ï¼ˆä¸æ˜¯file://åè®®ï¼‰
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤æ‰€æœ‰è¯­è¨€æ–‡ä»¶éƒ½å·²æ­£ç¡®åŠ è½½
4. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæ–‡ä»¶è·¯å¾„</div>
                
                <h3>æ¨èè®¿é—®æ–¹å¼ï¼š</h3>
                <div class="code-block">
http://127.0.0.1:8000/test-dual-mode-language.html
http://127.0.0.1:8000/debug-language-switcher.html</div>
            </div>
        </div>
    </div>

    <!-- åŒæ¨¡å¼è¯­è¨€é€‰æ‹©å™¨ -->
    <script src="i18n/components/dual-mode-language-switcher.js"></script>
    
    <!-- ç®€åŒ–æµ‹è¯•ç‰ˆæœ¬ -->
    <script>
    console.log('ğŸ§ª æµ‹è¯•ç®€åŒ–ç‰ˆæœ¬è¯­è¨€åˆ‡æ¢å™¨');
    
    // ç®€åŒ–ç‰ˆè¯­è¨€åˆ‡æ¢å™¨
    class SimpleLanguageSwitcher {
        constructor() {
            console.log('âœ… SimpleLanguageSwitcher æ„é€ å‡½æ•°è°ƒç”¨');
            this.currentLanguage = 'zh';
            this.element = null;
            this.createSwitcher();
        }
        
        createSwitcher() {
            console.log('âœ… SimpleLanguageSwitcher createSwitcher è°ƒç”¨');
            this.element = document.createElement('div');
            this.element.style.cssText = 'position:fixed;top:60px;right:20px;background:white;border:1px solid #ccc;padding:10px;border-radius:5px;z-index:9999;';
            this.element.innerHTML = `
                <div>ç®€åŒ–æµ‹è¯•åˆ‡æ¢å™¨</div>
                <button onclick="window.simpleSwitcher.test('zh')">ä¸­æ–‡</button>
                <button onclick="window.simpleSwitcher.test('en')">è‹±æ–‡</button>
                <button onclick="window.simpleSwitcher.test('ja')">æ—¥æ–‡</button>
            `;
            document.body.appendChild(this.element);
            console.log('âœ… SimpleLanguageSwitcher DOM å·²æ·»åŠ ');
        }
        
        test(lang) {
            console.log('ğŸ§ª ç®€åŒ–åˆ‡æ¢å™¨æµ‹è¯•:', lang);
            this.currentLanguage = lang;
            alert(`è¯­è¨€åˆ‡æ¢åˆ°: ${lang}`);
        }
        
        setLanguage(lang) {
            this.test(lang);
        }
    }
    
    // æš´éœ²ç®€åŒ–ç‰ˆæœ¬
    window.SimpleLanguageSwitcher = SimpleLanguageSwitcher;
    console.log('âœ… SimpleLanguageSwitcher å·²æš´éœ²åˆ°å…¨å±€');
    
    // ç«‹å³åˆ›å»ºç®€åŒ–ç‰ˆæœ¬å®ä¾‹
    try {
        window.simpleSwitcher = new SimpleLanguageSwitcher();
        console.log('âœ… ç®€åŒ–ç‰ˆæœ¬å®ä¾‹åˆ›å»ºæˆåŠŸ');
    } catch (error) {
        console.error('âŒ ç®€åŒ–ç‰ˆæœ¬å®ä¾‹åˆ›å»ºå¤±è´¥:', error);
    }
    </script>
    
    <script>
        let debugSwitcher = null;
        let consoleOutput = [];
        
        // é‡å†™console.logä»¥æ•è·è¾“å‡º
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addConsoleOutput(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            consoleOutput.push(`[${timestamp}] [${type.toUpperCase()}] ${message}`);
            updateConsoleDisplay();
            
            // è°ƒç”¨åŸå§‹consoleæ–¹æ³•
            if (type === 'error') originalError(message);
            else if (type === 'warn') originalWarn(message);
            else originalLog(message);
        }
        
        console.log = (message) => addConsoleOutput(message, 'log');
        console.error = (message) => addConsoleOutput(message, 'error');
        console.warn = (message) => addConsoleOutput(message, 'warn');
        
        function updateConsoleDisplay() {
            const outputEl = document.getElementById('consoleOutput');
            outputEl.textContent = consoleOutput.slice(-10).join('\n');
        }
        
        function clearConsole() {
            consoleOutput = [];
            updateConsoleDisplay();
        }
        
        function setStatus(elementId, status, message) {
            const el = document.getElementById(elementId);
            if (el) {
                const statusEl = el.querySelector('span:last-child');
                statusEl.textContent = message;
                
                el.className = 'status-item';
                if (status === 'success') el.classList.add('status-success');
                else if (status === 'error') el.classList.add('status-error');
                else if (status === 'warning') el.classList.add('status-warning');
            }
        }
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ è°ƒè¯•é¡µé¢åˆå§‹åŒ–å¼€å§‹');
            
            // æ£€æŸ¥CSSæ–‡ä»¶åŠ è½½
            setTimeout(() => {
                const cssRules = Array.from(document.styleSheets).some(sheet => {
                    try {
                        return Array.from(sheet.cssRules || sheet.rules || []).some(rule => 
                            rule.selectorText && rule.selectorText.includes('dual-mode-language-switcher')
                        );
                    } catch(e) {
                        return false;
                    }
                });
                
                if (cssRules) {
                    setStatus('cssCheck', 'success', 'âœ… å·²åŠ è½½');
                    console.log('âœ… CSSæ–‡ä»¶åŠ è½½æˆåŠŸ');
                } else {
                    setStatus('cssCheck', 'error', 'âŒ æœªåŠ è½½');
                    console.error('âŒ CSSæ–‡ä»¶åŠ è½½å¤±è´¥');
                }
            }, 100);
            
            // è¯¦ç»†æ£€æŸ¥JavaScriptæ‰§è¡ŒçŠ¶æ€
            console.log('ğŸ” è¯¦ç»†æ£€æŸ¥JavaScriptæ‰§è¡ŒçŠ¶æ€:');
            console.log('  - windowå¯¹è±¡å­˜åœ¨:', typeof window !== 'undefined');
            console.log('  - documentå¯¹è±¡å­˜åœ¨:', typeof document !== 'undefined');
            console.log('  - DualModeLanguageSwitcherç±»å‹:', typeof DualModeLanguageSwitcher);
            console.log('  - window.DualModeLanguageSwitcherç±»å‹:', typeof window.DualModeLanguageSwitcher);
            console.log('  - è„šæœ¬æ ‡ç­¾æ•°é‡:', document.scripts.length);
            console.log('  - æœ€åä¸€ä¸ªè„šæœ¬src:', document.scripts[document.scripts.length-1]?.src);
            
            // å°è¯•æ‰‹åŠ¨æ‰§è¡Œæ£€æŸ¥
            try {
                console.log('  - å°è¯•è®¿é—®DualModeLanguageSwitcher:', DualModeLanguageSwitcher);
            } catch (refError) {
                console.error('  - è®¿é—®DualModeLanguageSwitcheræ—¶å‡ºé”™:', refError);
            }
            
            // æ£€æŸ¥JavaScriptç±»
            if (typeof DualModeLanguageSwitcher !== 'undefined') {
                setStatus('jsCheck', 'success', 'âœ… å·²åŠ è½½');
                setStatus('classCheck', 'success', 'âœ… å·²å®šä¹‰');
                console.log('âœ… JavaScriptæ–‡ä»¶å’Œç±»åŠ è½½æˆåŠŸ');
                
                // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œé¿å…ä¸è‡ªåŠ¨åˆå§‹åŒ–å†²çª
                setTimeout(() => {
                    try {
                        // å…ˆæ£€æŸ¥æ˜¯å¦å·²æœ‰è‡ªåŠ¨åˆ›å»ºçš„å®ä¾‹
                        if (window.dualModeLanguageSwitcher) {
                            debugSwitcher = window.dualModeLanguageSwitcher;
                            console.log('âœ… ä½¿ç”¨è‡ªåŠ¨åˆ›å»ºçš„è¯­è¨€é€‰æ‹©å™¨å®ä¾‹');
                            setStatus('instanceCheck', 'success', 'âœ… ä½¿ç”¨è‡ªåŠ¨å®ä¾‹');
                        } else {
                            // æ‰‹åŠ¨åˆ›å»ºå®ä¾‹
                            debugSwitcher = new DualModeLanguageSwitcher({
                                onLanguageChange: function(langCode) {
                                    console.log(`ğŸ”„ è¯­è¨€åˆ‡æ¢å›è°ƒè§¦å‘ï¼Œå‚æ•°:`, langCode);
                                    console.log(`  - å‚æ•°ç±»å‹:`, typeof langCode);
                                    console.log(`  - å‚æ•°å€¼:`, langCode);
                                    setStatus('functionTest', 'success', `âœ… è¯­è¨€åˆ‡æ¢æˆåŠŸ: ${langCode || 'æœªçŸ¥'}`);
                                },
                                onModeChange: function(mode) {
                                    console.log(`ğŸ”„ æ¨¡å¼åˆ‡æ¢å›è°ƒè§¦å‘ï¼Œå‚æ•°:`, mode);
                                    console.log(`  - å‚æ•°ç±»å‹:`, typeof mode);
                                    console.log(`  - å‚æ•°å€¼:`, mode);
                                    setStatus('functionTest', 'success', `âœ… æ¨¡å¼åˆ‡æ¢æˆåŠŸ: ${mode || 'æœªçŸ¥'}`);
                                }
                            });
                            console.log('âœ… æ‰‹åŠ¨åˆ›å»ºè¯­è¨€é€‰æ‹©å™¨å®ä¾‹æˆåŠŸ');
                            setStatus('instanceCheck', 'success', 'âœ… æ‰‹åŠ¨åˆ›å»ºæˆåŠŸ');
                        }
                        
                        // æ£€æŸ¥DOMæŒ‚è½½
                        setTimeout(() => {
                            const domEl = document.querySelector('.dual-mode-language-switcher');
                            if (domEl) {
                                setStatus('domCheck', 'success', 'âœ… å·²æŒ‚è½½');
                                console.log('âœ… DOMå…ƒç´ æŒ‚è½½æˆåŠŸ');
                            } else {
                                setStatus('domCheck', 'error', 'âŒ æœªæŒ‚è½½');
                                console.error('âŒ DOMå…ƒç´ æŒ‚è½½å¤±è´¥');
                            }
                        }, 300);
                        
                    } catch (error) {
                        setStatus('instanceCheck', 'error', 'âŒ åˆå§‹åŒ–å¤±è´¥');
                        console.error('âŒ åˆå§‹åŒ–å¤±è´¥:');
                        console.error('  - é”™è¯¯å¯¹è±¡:', error);
                        console.error('  - é”™è¯¯ç±»å‹:', typeof error);
                        console.error('  - é”™è¯¯æ¶ˆæ¯:', error ? error.message : 'æ— æ¶ˆæ¯');
                        console.error('  - é”™è¯¯å †æ ˆ:', error ? error.stack : 'æ— å †æ ˆ');
                        console.error('  - é”™è¯¯åç§°:', error ? error.name : 'æ— åç§°');
                        console.error('  - é”™è¯¯toString:', error ? error.toString() : 'æ— toString');
                        
                        // æ£€æŸ¥æ„é€ å‡½æ•°æ˜¯å¦å­˜åœ¨
                        console.error('  - DualModeLanguageSwitcheræ˜¯å¦ä¸ºå‡½æ•°:', typeof DualModeLanguageSwitcher === 'function');
                        console.error('  - DualModeLanguageSwitcher.length:', DualModeLanguageSwitcher ? DualModeLanguageSwitcher.length : 'undefined');
                        
                        // å°è¯•ä½¿ç”¨å…¨å±€å®ä¾‹ä½œä¸ºå¤‡ç”¨
                        if (window.dualModeLanguageSwitcher) {
                            debugSwitcher = window.dualModeLanguageSwitcher;
                            console.log('ğŸ”„ ä½¿ç”¨å…¨å±€å®ä¾‹ä½œä¸ºå¤‡ç”¨');
                            setStatus('instanceCheck', 'warning', 'âš ï¸ ä½¿ç”¨å¤‡ç”¨å®ä¾‹');
                        } else {
                            // å°è¯•ä¸å¸¦å‚æ•°çš„æ„é€ 
                            console.log('ğŸ”„ å°è¯•æ— å‚æ•°æ„é€ ...');
                            try {
                                debugSwitcher = new DualModeLanguageSwitcher();
                                console.log('âœ… æ— å‚æ•°æ„é€ æˆåŠŸ');
                                setStatus('instanceCheck', 'warning', 'âš ï¸ æ— å‚æ•°æ„é€ æˆåŠŸ');
                            } catch (simpleError) {
                                console.error('âŒ æ— å‚æ•°æ„é€ ä¹Ÿå¤±è´¥:', simpleError);
                                console.error('âŒ æ— å‚æ•°æ„é€ é”™è¯¯æ¶ˆæ¯:', simpleError ? simpleError.message : 'æ— æ¶ˆæ¯');
                            }
                        }
                    }
                }, 200); // å»¶è¿Ÿ200msä»¥ç¡®ä¿è‡ªåŠ¨åˆå§‹åŒ–å®Œæˆ
                
            } else {
                setStatus('jsCheck', 'error', 'âŒ æœªåŠ è½½');
                setStatus('classCheck', 'error', 'âŒ æœªå®šä¹‰');
                setStatus('instanceCheck', 'error', 'âŒ æ— æ³•åˆå§‹åŒ–');
                console.error('âŒ DualModeLanguageSwitcherç±»æœªå®šä¹‰');
            }
            
            // æ£€æŸ¥è¯­è¨€æ–‡ä»¶
            setTimeout(checkLanguageFiles, 500);
        });
        
                 async function checkLanguageFiles() {
             const languages = ['zh', 'en', 'ja'];
             
             for (const lang of languages) {
                 try {
                     const response = await fetch(`i18n/languages/${lang}.js`);
                     if (response.ok) {
                         setStatus(`${lang}Check`, 'success', 'âœ… å¯è®¿é—®');
                         console.log(`âœ… è¯­è¨€æ–‡ä»¶ ${lang}.js å¯è®¿é—®`);
                     } else {
                         setStatus(`${lang}Check`, 'error', `âŒ æ— æ³•è®¿é—® (${response.status})`);
                         console.error(`âŒ è¯­è¨€æ–‡ä»¶ ${lang}.js æ— æ³•è®¿é—®ï¼ŒçŠ¶æ€ç :`, response.status);
                     }
                 } catch (error) {
                     setStatus(`${lang}Check`, 'error', 'âŒ åŠ è½½å¤±è´¥');
                     console.error(`âŒ è¯­è¨€æ–‡ä»¶ ${lang}.js åŠ è½½å¤±è´¥:`, error);
                     console.error('âŒ é”™è¯¯è¯¦æƒ…:', error.message);
                     console.error('âŒ å¯èƒ½çš„åŸå› : CORSç­–ç•¥ã€ç½‘ç»œé—®é¢˜æˆ–æ–‡ä»¶ä¸å­˜åœ¨');
                 }
             }
         }
        
        // æµ‹è¯•å‡½æ•°
        function testLanguageSwitch(langCode) {
            console.log(`ğŸ§ª æµ‹è¯•è¯­è¨€åˆ‡æ¢åˆ°: ${langCode}`);
            
            // å¤šé‡æ£€æŸ¥å’Œé‡è¯•æœºåˆ¶
            let switcher = null;
            
            if (debugSwitcher) {
                switcher = debugSwitcher;
                console.log('âœ… ä½¿ç”¨debugSwitcherå®ä¾‹');
            } else if (window.dualModeLanguageSwitcher) {
                switcher = window.dualModeLanguageSwitcher;
                console.log('âœ… ä½¿ç”¨å…¨å±€dualModeLanguageSwitcherå®ä¾‹');
            } else if (window.globalLanguageSwitcher) {
                switcher = window.globalLanguageSwitcher;
                console.log('âœ… ä½¿ç”¨å…¨å±€globalLanguageSwitcherå®ä¾‹');
            }
            
            if (switcher && typeof switcher.setLanguage === 'function') {
                try {
                    switcher.setLanguage(langCode);
                    console.log(`âœ… è¯­è¨€åˆ‡æ¢å‘½ä»¤å·²å‘é€: ${langCode}`);
                } catch (error) {
                    console.error(`âŒ è¯­è¨€åˆ‡æ¢æ—¶å‡ºé”™:`, error);
                    setStatus('functionTest', 'error', `âŒ åˆ‡æ¢å¤±è´¥: ${error.message}`);
                }
            } else {
                // å°è¯•ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬ä½œä¸ºå¤‡ç”¨
                if (window.simpleSwitcher && typeof window.simpleSwitcher.setLanguage === 'function') {
                    console.log('ğŸ”„ ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬åˆ‡æ¢å™¨');
                    window.simpleSwitcher.setLanguage(langCode);
                    setStatus('functionTest', 'warning', `âš ï¸ ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬: ${langCode}`);
                    return;
                }
                
                // è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
                console.error('âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–');
                console.error('è°ƒè¯•ä¿¡æ¯:');
                console.error('- debugSwitcher:', debugSwitcher);
                console.error('- window.dualModeLanguageSwitcher:', window.dualModeLanguageSwitcher);
                console.error('- window.globalLanguageSwitcher:', window.globalLanguageSwitcher);
                console.error('- window.simpleSwitcher:', window.simpleSwitcher);
                console.error('- DualModeLanguageSwitcherç±»å­˜åœ¨:', typeof DualModeLanguageSwitcher !== 'undefined');
                console.error('- SimpleLanguageSwitcherç±»å­˜åœ¨:', typeof SimpleLanguageSwitcher !== 'undefined');
                
                setStatus('functionTest', 'error', 'âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–');
                
                // å°è¯•å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–
                console.log('ğŸ”„ å°è¯•å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–...');
                setTimeout(() => {
                    if (typeof DualModeLanguageSwitcher !== 'undefined') {
                        try {
                            debugSwitcher = new DualModeLanguageSwitcher();
                            console.log('âœ… å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–æˆåŠŸ');
                            debugSwitcher.setLanguage(langCode);
                        } catch (error) {
                            console.error('âŒ å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–å¤±è´¥:', error);
                        }
                    } else if (typeof SimpleLanguageSwitcher !== 'undefined') {
                        try {
                            debugSwitcher = new SimpleLanguageSwitcher();
                            console.log('âœ… ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬é‡æ–°åˆå§‹åŒ–æˆåŠŸ');
                            debugSwitcher.setLanguage(langCode);
                        } catch (error) {
                            console.error('âŒ ç®€åŒ–ç‰ˆæœ¬é‡æ–°åˆå§‹åŒ–å¤±è´¥:', error);
                        }
                    }
                }, 100);
            }
        }
        
        function testModeSwitch(mode) {
            console.log(`ğŸ§ª æµ‹è¯•æ¨¡å¼åˆ‡æ¢åˆ°: ${mode}`);
            
            let switcher = null;
            
            if (debugSwitcher) {
                switcher = debugSwitcher;
            } else if (window.dualModeLanguageSwitcher) {
                switcher = window.dualModeLanguageSwitcher;
            }
            
            if (switcher && typeof switcher.setDetectionMode === 'function') {
                try {
                    switcher.setDetectionMode(mode);
                    console.log(`âœ… æ¨¡å¼åˆ‡æ¢å‘½ä»¤å·²å‘é€: ${mode}`);
                } catch (error) {
                    console.error(`âŒ æ¨¡å¼åˆ‡æ¢æ—¶å‡ºé”™:`, error);
                    setStatus('functionTest', 'error', `âŒ æ¨¡å¼åˆ‡æ¢å¤±è´¥: ${error.message}`);
                }
            } else {
                setStatus('functionTest', 'error', 'âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–');
                console.error('âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–ï¼Œæ— æ³•åˆ‡æ¢æ¨¡å¼');
            }
        }
    </script>
</body>
</html> 