<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ğŸ” Debugé—®é¢˜æœ€å°åŒ–æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f0f0f0; }
        .log { background: #000; color: #0f0; padding: 15px; height: 300px; overflow-y: auto; font-family: monospace; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ğŸ” Debugé—®é¢˜æœ€å°åŒ–æµ‹è¯•</h1>
    
    <div>
        <button onclick="testStep1()">1. åªåˆ›å»ºå®ä¾‹</button>
        <button onclick="testStep2()">2. æµ‹è¯•debugLog</button>
        <button onclick="testStep3()">3. æµ‹è¯•info</button>
        <button onclick="testStep4()">4. æµ‹è¯•error</button>
        <button onclick="testStep5()">5. æµ‹è¯•write</button>
        <button onclick="clearLog()">æ¸…ç©º</button>
    </div>
    
    <div id="log" class="log">
å‡†å¤‡å¼€å§‹åˆ†æ­¥æµ‹è¯•...
    </div>

    <script src="downloaders/base-downloader.js"></script>
    <script src="downloaders/esp32/esp32-esptool-js-wrapper.js"></script>

    <script>
        function log(msg) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${msg}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        let downloader = null;

        function testStep1() {
            try {
                log('ğŸ” æ­¥éª¤1: åˆ›å»ºESP32EsptoolJSWrapperå®ä¾‹...');
                downloader = new ESP32EsptoolJSWrapper(null, {
                    log: (msg) => log(`[CALLBACK] ${msg}`)
                });
                log('âœ… å®ä¾‹åˆ›å»ºæˆåŠŸ');
                log(`- debugLogæ–¹æ³•: ${typeof downloader.debugLog}`);
                log(`- infoæ–¹æ³•: ${typeof downloader.info}`);
                log(`- erroræ–¹æ³•: ${typeof downloader.error}`);
                log(`- writeæ–¹æ³•: ${typeof downloader.write}`);
                log(`- debugå±æ€§: ${typeof downloader.debug}`);
                log(`- baseDebugFunction: ${typeof downloader.baseDebugFunction}`);
            } catch (error) {
                log(`âŒ æ­¥éª¤1å¤±è´¥: ${error.message}`);
                console.error('æ­¥éª¤1è¯¦ç»†é”™è¯¯:', error);
            }
        }

        function testStep2() {
            if (!downloader) {
                log('âŒ è¯·å…ˆæ‰§è¡Œæ­¥éª¤1åˆ›å»ºå®ä¾‹');
                return;
            }
            
            try {
                log('ğŸ” æ­¥éª¤2: æµ‹è¯•debugLogæ–¹æ³•...');
                downloader.debugLog('è¿™æ˜¯debugLogæµ‹è¯•æ¶ˆæ¯');
                log('âœ… debugLogè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                log(`âŒ æ­¥éª¤2å¤±è´¥: ${error.message}`);
                console.error('æ­¥éª¤2è¯¦ç»†é”™è¯¯:', error);
                console.error('é”™è¯¯å †æ ˆ:', error.stack);
            }
        }

        function testStep3() {
            if (!downloader) {
                log('âŒ è¯·å…ˆæ‰§è¡Œæ­¥éª¤1åˆ›å»ºå®ä¾‹');
                return;
            }
            
            try {
                log('ğŸ” æ­¥éª¤3: æµ‹è¯•infoæ–¹æ³•...');
                downloader.info('è¿™æ˜¯infoæµ‹è¯•æ¶ˆæ¯');
                log('âœ… infoè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                log(`âŒ æ­¥éª¤3å¤±è´¥: ${error.message}`);
                console.error('æ­¥éª¤3è¯¦ç»†é”™è¯¯:', error);
                console.error('é”™è¯¯å †æ ˆ:', error.stack);
            }
        }

        function testStep4() {
            if (!downloader) {
                log('âŒ è¯·å…ˆæ‰§è¡Œæ­¥éª¤1åˆ›å»ºå®ä¾‹');
                return;
            }
            
            try {
                log('ğŸ” æ­¥éª¤4: æµ‹è¯•erroræ–¹æ³•...');
                downloader.error('è¿™æ˜¯erroræµ‹è¯•æ¶ˆæ¯');
                log('âœ… errorè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                log(`âŒ æ­¥éª¤4å¤±è´¥: ${error.message}`);
                console.error('æ­¥éª¤4è¯¦ç»†é”™è¯¯:', error);
                console.error('é”™è¯¯å †æ ˆ:', error.stack);
            }
        }

        function testStep5() {
            if (!downloader) {
                log('âŒ è¯·å…ˆæ‰§è¡Œæ­¥éª¤1åˆ›å»ºå®ä¾‹');
                return;
            }
            
            try {
                log('ğŸ” æ­¥éª¤5: æµ‹è¯•writeæ–¹æ³•...');
                downloader.write('è¿™æ˜¯writeæµ‹è¯•æ¶ˆæ¯');
                log('âœ… writeè°ƒç”¨æˆåŠŸ');
            } catch (error) {
                log(`âŒ æ­¥éª¤5å¤±è´¥: ${error.message}`);
                console.error('æ­¥éª¤5è¯¦ç»†é”™è¯¯:', error);
                console.error('é”™è¯¯å †æ ˆ:', error.stack);
            }
        }
    </script>
</body>
</html> 