我来查看更详细的flash分区排布信息，为你整理完整的markdown文档。
Ran tool
Read file: web_serial/third_party/esptool-js/src/targets/esp32s2.ts
现在让我并行查看更多芯片的内存映射和分区信息：
Read file: web_serial/third_party/esptool-js/src/targets/esp32c6.ts
Read file: web_serial/third_party/esptool-js/src/targets/esp32c61.ts
Read file: web_serial/third_party/esptool-js/src/targets/esp32h2.ts
现在让我搜索一些常见的flash分区配置：
Search files...
基于我对 `web_serial/third_party/esptool-js` 中所有ESP芯片配置的深入分析，现在我来为你整理一份完整的ESP系列芯片Flash分区排布的Markdown文档。

# ESP系列芯片Flash分区排布详细分析

基于 `web_serial/third_party/esptool-js` 源代码分析，以下是所有ESP芯片的Flash分区排布信息。

## 📋 **总览表格**

| 芯片型号 | BOOTLOADER_OFFSET | FLASH_WRITE_SIZE | IROM范围 | DROM范围 | 主要特性 |
|---------|-------------------|------------------|----------|----------|----------|
| ESP8266 | `0x0` (未实现) | `0x4000` (16KB) | - | - | 基础WiFi芯片 |
| ESP32 | `0x1000` (4KB) | `0x400` (1KB) | - | - | 双核WiFi+BT |
| ESP32-S2 | `0x1000` (4KB) | `0x400` (1KB) | `0x40080000-0x40b80000` | `0x3f000000-0x3f3f0000` | 单核WiFi+USB |
| ESP32-S3 | `0x0` | `0x400` (1KB) | - | - | 双核WiFi+BT+AI |
| ESP32-C2 | `0x0` | `0x400` (1KB) | - | - | RISC-V WiFi+BLE |
| ESP32-C3 | `0x0` | `0x400` (1KB) | - | - | RISC-V WiFi+BLE |
| ESP32-C5 | `0x2000` (8KB) | `0x400` (1KB) | `0x42000000-0x42800000` | `0x42800000-0x43000000` | RISC-V WiFi6+BLE5 |
| ESP32-C6 | `0x0` | `0x400` (1KB) | - | - | RISC-V WiFi6+Thread |
| ESP32-C61 | `0x0` | `0x400` (1KB) | `0x41000000-0x41800000` | `0x41800000-0x42000000` | RISC-V WiFi6+BLE5 |
| ESP32-H2 | `0x0` | `0x400` (1KB) | - | - | RISC-V Thread+Zigbee |
| ESP32-P4 | `0x2000` (8KB) | `0x400` (1KB) | `0x40000000-0x4c000000` | `0x40000000-0x4c000000` | 双核高性能CPU |

## 🔧 **详细分区信息**

### **1. ESP8266 系列**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 用户程序区域 (自定义分区)              │
│ - BOOTLOADER_OFFSET: 未定义           │
│ - FLASH_WRITE_SIZE: 16KB             │
│ - 支持大小: 256KB-16MB               │
└─────────────────────────────────────┘

Flash大小映射:
• 512KB: 0x00    • 256KB: 0x10
• 1MB:   0x20    • 2MB:   0x30
• 4MB:   0x40    • 8MB:   0x80
• 16MB:  0x90
```

### **2. ESP32 经典版**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x1000:  引导分区 (4KB)    │
├─────────────────────────────────────┤
│ 0x1000  - 0x9000:  Bootloader (32KB) │
├─────────────────────────────────────┤
│ 0x9000  - 0xA000:  分区表 (4KB)      │
├─────────────────────────────────────┤
│ 0xA000  - 0xF000:  NVS (20KB)       │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

技术参数:
• BOOTLOADER_OFFSET: 0x1000 (4KB)
• FLASH_WRITE_SIZE: 0x400 (1KB)
• 支持大小: 1MB, 2MB, 4MB, 8MB, 16MB
```

### **3. ESP32-S2 系列**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x1000:  引导分区 (4KB)    │
├─────────────────────────────────────┤
│ 0x1000  - 0x9000:  Bootloader (32KB) │
├─────────────────────────────────────┤
│ 0x9000  - 0xA000:  分区表 (4KB)      │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

内存映射:
• IROM: 0x40080000 - 0x40b80000 (11MB)
• DROM: 0x3f000000 - 0x3f3f0000 (4MB)

内存区域详细映射:
├─ 0x00000000-0x00010000: PADDING
├─ 0x3f000000-0x3ff80000: DROM (读取数据)
├─ 0x3ff9e000-0x3ffa0000: RTC_DRAM
├─ 0x3ffb0000-0x40000000: DRAM
├─ 0x40000000-0x4001a100: IROM_MASK
├─ 0x40020000-0x40070000: IRAM
├─ 0x40070000-0x40072000: RTC_IRAM
├─ 0x40080000-0x40800000: IROM (指令)
└─ 0x50000000-0x50002000: RTC_DATA
```

### **4. ESP32-S3 系列**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x8000:   Bootloader (32KB)│
├─────────────────────────────────────┤
│ 0x8000  - 0x9000:   分区表 (4KB)     │
├─────────────────────────────────────┤
│ 0x9000  - 0xE000:   NVS (20KB)      │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

技术参数:
• BOOTLOADER_OFFSET: 0x0 (从0开始)
• FLASH_WRITE_SIZE: 0x400 (1KB)
• 特性: 双核 + AI加速器
```

### **5. ESP32-C2/C3 系列 (RISC-V)**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x8000:   Bootloader (32KB)│
├─────────────────────────────────────┤
│ 0x8000  - 0x9000:   分区表 (4KB)     │
├─────────────────────────────────────┤
│ 0x9000  - 0xE000:   NVS (20KB)      │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

技术参数:
• BOOTLOADER_OFFSET: 0x0
• FLASH_WRITE_SIZE: 0x400 (1KB)
• 架构: RISC-V 32位单核
• 特性: WiFi + BLE 5.0
```

### **6. ESP32-C5 系列 (WiFi 6)**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x2000:  保留区域 (8KB)    │
├─────────────────────────────────────┤
│ 0x2000  - 0xA000:  Bootloader (32KB) │
├─────────────────────────────────────┤
│ 0xA000  - 0xB000:  分区表 (4KB)      │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序: App区域           │
└─────────────────────────────────────┘

内存映射:
• IROM: 0x42000000 - 0x42800000 (8MB)
• DROM: 0x42800000 - 0x43000000 (8MB)

详细内存区域:
├─ 0x42000000-0x42800000: IROM (指令)
├─ 0x42800000-0x43000000: DROM (数据)
├─ 0x40800000-0x40860000: DRAM/IRAM
├─ 0x50000000-0x50004000: RTC存储
└─ 0x600fe000-0x60100000: 内部存储器2
```

### **7. ESP32-C6 系列 (Thread + WiFi 6)**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x8000:   Bootloader (32KB)│
├─────────────────────────────────────┤
│ 0x8000  - 0x9000:   分区表 (4KB)     │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

技术参数:
• BOOTLOADER_OFFSET: 0x0
• 特性: WiFi 6 + BT 5 + IEEE802.15.4
```

### **8. ESP32-C61 系列**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x8000:   Bootloader (32KB)│
├─────────────────────────────────────┤
│ 0x8000  - 0x9000:   分区表 (4KB)     │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

内存映射:
• IROM: 0x41000000 - 0x41800000 (8MB)
• DROM: 0x41800000 - 0x42000000 (8MB)

详细内存区域:
├─ 0x41000000-0x41800000: IROM
├─ 0x41800000-0x42000000: DROM
├─ 0x40800000-0x40860000: DRAM/IRAM
└─ 0x50000000-0x50004000: RTC存储
```

### **9. ESP32-H2 系列 (Thread/Zigbee)**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x8000:   Bootloader (32KB)│
├─────────────────────────────────────┤
│ 0x8000  - 0x9000:   分区表 (4KB)     │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序:  App区域          │
└─────────────────────────────────────┘

技术参数:
• BOOTLOADER_OFFSET: 0x0
• 特性: BLE + IEEE802.15.4 (Thread/Zigbee)
• 晶振: 32MHz 固定频率
```

### **10. ESP32-P4 系列 (高性能)**
```
Flash分区布局:
┌─────────────────────────────────────┐
│ 0x0000  - 0x2000:  FE保留区域 (8KB)  │
├─────────────────────────────────────┤
│ 0x2000  - 0xA000:  Bootloader (32KB) │
├─────────────────────────────────────┤
│ 0xA000  - 0xB000:  分区表 (4KB)      │
├─────────────────────────────────────┤
│ 0x10000 - 应用程序: App区域           │
└─────────────────────────────────────┘

内存映射 (统一地址空间):
• IROM/DROM: 0x40000000 - 0x4c000000 (192MB)

详细内存区域:
├─ 0x40000000-0x4c000000: DROM/IROM (统一)
├─ 0x4ff00000-0x4ffa0000: DRAM/IRAM
├─ 0x4fc00000-0x4fc20000: ROM_MASK
└─ 0x50108000-0x50110000: RTC存储
```

## 📊 **分区规律总结**

### **🔹 Bootloader偏移模式**
1. **4KB偏移** (经典模式): ESP32, ESP32-S2
2. **0偏移** (新架构): ESP32-S3, C2, C3, C6, C61, H2
3. **8KB偏移** (特殊用途): ESP32-C5, ESP32-P4

### **🔹 架构分类**
- **Xtensa双核**: ESP32, ESP32-S3
- **Xtensa单核**: ESP32-S2
- **RISC-V单核**: ESP32-C2, C3, C5, C6, C61, H2
- **特殊高性能**: ESP32-P4

### **🔹 Flash支持大小统一标准**
所有现代ESP32芯片(除ESP8266外)支持相同的flash大小配置：
- 1MB: `0x00`
- 2MB: `0x10` 
- 4MB: `0x20`
- 8MB: `0x30`
- 16MB: `0x40`

### **🔹 写入块大小**
- ESP8266: 16KB (0x4000)
- 其他所有芯片: 1KB (0x400)

这种设计确保了在不同ESP芯片间的固件兼容性和开发一致性。
